{"_path":"/android/lesson10/work-manager","_dir":"lesson10","_draft":false,"_partial":false,"_locale":"","title":"WorkManager. Вступ","description":"Важлива частина роботи програми - це фонова робота. Це може бути завантаження або аплоад, стиснення або розпакування, синхронізація тощо. Колись давно для фонової роботи були призначені сервіси. Але в Android 8 їх дуже сильно обмежили: якщо застосунок не активний, то і сервіс буде зупинений через якийсь час. Та й ще задовго до Android 8 розробники почали використовувати такі інструменти як JobScheduler або Firebase JobDispatcher для запуску фонових завдань.","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"workmanager-вступ"},"children":[{"type":"text","value":"WorkManager. Вступ"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Важлива частина роботи програми - це фонова робота. Це може бути "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"завантаження"}]},{"type":"text","value":" або "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"аплоад"}]},{"type":"text","value":", "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"стиснення"}]},{"type":"text","value":" або "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"розпакування"}]},{"type":"text","value":", "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"синхронізація"}]},{"type":"text","value":" тощо. Колись давно для фонової роботи були призначені "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"сервіси"}]},{"type":"text","value":". Але в Android 8 їх дуже сильно обмежили: якщо застосунок не активний, то і сервіс буде зупинений через якийсь час. Та й ще задовго до Android 8 розробники почали використовувати такі інструменти як "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"JobScheduler"}]},{"type":"text","value":" або "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Firebase JobDispatcher"}]},{"type":"text","value":" для запуску фонових завдань."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"WorkManager"}]},{"type":"text","value":" - \"новий інструмент\". Він дає змогу запускати фонові завдання послідовно або паралельно, передавати в них дані, отримувати з них результат, відстежувати статус виконання і запускати тільки за дотримання заданих умов. При цьому він дуже простий у використанні."}]},{"type":"element","tag":"h2","props":{"id":"завдання"},"children":[{"type":"text","value":"Завдання"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Давайте створимо і запустимо фонове завдання."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Додайте в "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"dependencies"}]}]},{"type":"element","tag":"pre","props":{"className":"language-ini shiki shiki-themes github-dark github-light monokai","code":"implementation \"android.arch.work:work-runtime:2.9.1\"\n","language":"ini","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"implementation "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"\"android.arch.work:work-runtime:2.9.1\"\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Створюємо клас, що наслідує клас "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Worker"}]},{"type":"text","value":":"}]},{"type":"element","tag":"pre","props":{"className":"language-java shiki shiki-themes github-dark github-light monokai","code":"public class MyWorker extends Worker {\n \n    static final String TAG = \"workmng\";\n \n    @NonNull\n    @Override\n    public WorkerResult doWork() {\n        Log.d(TAG, \"doWork: start\");\n \n        try {\n            TimeUnit.SECONDS.sleep(10);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n \n        Log.d(TAG, \"doWork: end\");\n \n        return WorkerResult.SUCCESS;\n    }\n}\n","language":"java","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"public"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":" class"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-dark-text-decoration:inherit;--shiki-default:#6F42C1;--shiki-default-text-decoration:inherit;--shiki-sepia:#A6E22E;--shiki-sepia-text-decoration:underline"},"children":[{"type":"text","value":" MyWorker"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":" extends"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-dark-font-style:inherit;--shiki-dark-text-decoration:inherit;--shiki-default:#6F42C1;--shiki-default-font-style:inherit;--shiki-default-text-decoration:inherit;--shiki-sepia:#A6E22E;--shiki-sepia-font-style:italic;--shiki-sepia-text-decoration:underline"},"children":[{"type":"text","value":" Worker"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" \n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"    static"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":" final"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-dark-font-style:inherit;--shiki-default:#24292E;--shiki-default-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":" String"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" TAG "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" \"workmng\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" \n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"    @"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"NonNull\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"    @"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"Override\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"    public"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-dark-font-style:inherit;--shiki-default:#24292E;--shiki-default-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":" WorkerResult"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":" doWork"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"() {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"        Log."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"d"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"(TAG, "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"\"doWork: start\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" \n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"        try"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"            TimeUnit.SECONDS."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"sleep"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5;--shiki-sepia:#AE81FF"},"children":[{"type":"text","value":"10"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"        } "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"catch"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-dark-font-style:inherit;--shiki-default:#24292E;--shiki-default-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"InterruptedException"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-default:#E36209;--shiki-default-font-style:inherit;--shiki-sepia:#FD971F;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":" e"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":") {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"            e."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"printStackTrace"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"        }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" \n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"        Log."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"d"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"(TAG, "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"\"doWork: end\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" \n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"        return"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" WorkerResult.SUCCESS;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"У метод "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"doWork"}]},{"type":"text","value":" нам пропонується помістити код, який буде виконано. Я тут просто ставлю паузу в 10 секунд і повертаю результат "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"SUCCESS"}]},{"type":"text","value":", що означає, що все пройшло успішно. Нам не треба морочитися з потоками, тому що код буде виконано не в UI потоці."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Завдання готове. Тепер нам потрібно "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"MyWorker"}]},{"type":"text","value":" обернути в "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"WorkRequest"}]},{"type":"text","value":":"}]},{"type":"element","tag":"pre","props":{"className":"language-java shiki shiki-themes github-dark github-light monokai","code":"OneTimeWorkRequest myWorkRequest = new OneTimeWorkRequest.Builder(MyWorker.class).build();\n","language":"java","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-dark-font-style:inherit;--shiki-default:#24292E;--shiki-default-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"OneTimeWorkRequest"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" myWorkRequest "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":" new"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" OneTimeWorkRequest."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"Builder"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"(MyWorker.class)."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"build"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"();\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"WorkRequest"}]},{"type":"text","value":" дає нам змогу задати умови запуску та вхідні параметри до завдання. Поки що ми нічого не задаємо, а просто створюємо "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"OneTimeWorkRequest"}]},{"type":"text","value":", якому говоримо, що запускати треба буде завдання "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"MyWorker"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"OneTimeWorkRequest"}]},{"type":"text","value":" не дарма має таку назву. Це завдання буде виконано один раз. Є ще "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"PeriodicWorkRequest"}]},{"type":"text","value":", але про нього трохи пізніше."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Тепер можна запускати завдання:"}]},{"type":"element","tag":"pre","props":{"className":"language-java shiki shiki-themes github-dark github-light monokai","code":"WorkManager.getInstance().enqueue(myWorkRequest);\n","language":"java","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"WorkManager."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"getInstance"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"()."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"enqueue"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"(myWorkRequest);\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Беремо "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"WorkManager"}]},{"type":"text","value":" і в його метод "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"enqueue"}]},{"type":"text","value":" передаємо "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"WorkRequest"}]},{"type":"text","value":". Після цього завдання буде запущено."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Дивимося лог:"}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark github-light monokai","code":"20:37:36.567   5369-5444   doWork: start\n20:37:46.568   5369-5444   doWork: end\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"20:37:36.567"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"   5369-5444"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"   doWork:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" start\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"20:37:46.568"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"   5369-5444"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"   doWork:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" end\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Видно, що завдання виконувалося "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"10"}]},{"type":"text","value":" секунд, і код виконувався не в UI потоці."}]},{"type":"element","tag":"h2","props":{"id":"статус-завдання"},"children":[{"type":"text","value":"Статус завдання"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"WorkManager"}]},{"type":"text","value":" надає можливість відстежувати статус виконання завдання. Наприклад, в "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Activity"}]},{"type":"text","value":" пишемо:"}]},{"type":"element","tag":"pre","props":{"className":"language-java shiki shiki-themes github-dark github-light monokai","code":"WorkManager.getInstance().getStatusById(myWorkRequest.getId()).observe(this, new Observer<WorkStatus>() {\n   @Override\n   public void onChanged(@Nullable WorkStatus workStatus) {\n       Log.d(TAG, \"onChanged: \" + workStatus.getState());\n   }\n});\n","language":"java","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"WorkManager."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"getInstance"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"()."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"getStatusById"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"(myWorkRequest."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"getId"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"())."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"observe"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5;--shiki-sepia:#FD971F"},"children":[{"type":"text","value":"this"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"new"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-dark-font-style:inherit;--shiki-default:#24292E;--shiki-default-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":" Observer"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"WorkStatus"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":">() {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"   @"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"Override\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"   public"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":" void"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":" onChanged"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"(@"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"Nullable"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-dark-font-style:inherit;--shiki-default:#24292E;--shiki-default-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":" WorkStatus"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-default:#E36209;--shiki-default-font-style:inherit;--shiki-sepia:#FD971F;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":" workStatus"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":") {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"       Log."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"d"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"(TAG, "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"\"onChanged: \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":" +"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" workStatus."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"getState"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"());\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"   }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"});\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"У метод "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"getStatusById"}]},{"type":"text","value":" необхідно передати "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"ID"}]},{"type":"text","value":" завдання, який може бути отриманий методом "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"WorkRequest.getId"}]},{"type":"text","value":". У результаті ми отримуємо "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"LiveData"}]},{"type":"text","value":", підписуємося на нього і в метод "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"onChanged"}]},{"type":"text","value":" нам будуть приходити всі зміни статусу нашого завдання. Методом "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"WorkStatus.getState"}]},{"type":"text","value":" будемо отримувати поточний стан."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Запускаємо"}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark github-light monokai","code":"20:52:54.189   6060-6060   onChanged: ENQUEUED\n20:52:54.199   6060-6087   doWork: start\n20:52:54.203   6060-6060   onChanged: RUNNING\n20:53:04.200   6060-6087   doWork: end\n20:53:04.211   6060-6060   onChanged: SUCCEEDED\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"20:52:54.189"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"   6060-6060"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"   onChanged:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" ENQUEUED\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"20:52:54.199"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"   6060-6087"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"   doWork:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" start\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"20:52:54.203"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"   6060-6060"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"   onChanged:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" RUNNING\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"20:53:04.200"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"   6060-6087"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"   doWork:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" end\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"20:53:04.211"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"   6060-6060"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"   onChanged:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" SUCCEEDED\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Відразу після виклику методу enqueue завдання перебуває в статусі "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"ENQUEUED"}]},{"type":"text","value":". Потім "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"WorkManager"}]},{"type":"text","value":" визначає, що завдання можна запускати і виконує наш код. У цей момент статус змінюється на "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"RUNNING"}]},{"type":"text","value":". Після виконання статус буде "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"SUCCEEDED"}]},{"type":"text","value":", тому що ми повернули такий статус у методі doWork."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Статус нам приходить в UI потоці."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Тепер ще раз запустимо завдання і закриємо додаток:"}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark github-light monokai","code":"20:58:19.402   doWork: start\n20:58:19.424   onChanged: ENQUEUED\n20:58:19.462   onChanged: RUNNING\n20:58:29.403   doWork: end\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"20:58:19.402"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"   doWork:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" start\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"20:58:19.424"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"   onChanged:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" ENQUEUED\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"20:58:19.462"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"   onChanged:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" RUNNING\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"20:58:29.403"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"   doWork:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" end\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Зверніть увагу, завдання завершилося, а статус "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"SUCCEEDED"}]},{"type":"text","value":" не прийшов. Чому? Тому що, закривши "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Activity"}]},{"type":"text","value":", ми всього лише відписалися від "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"LiveData"}]},{"type":"text","value":", який передавав нам статуси завдання. Але саме завдання нікуди не поділося. Воно ніяк не залежить від застосунку і буде виконуватися, навіть якщо застосунок закрито."}]},{"type":"element","tag":"h1","props":{"id":"результат"},"children":[{"type":"text","value":"Результат"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Ми в нашому завданні повертали статус "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"WorkerResult.SUCCESS"}]},{"type":"text","value":", тим самим повідомляючи, що все ок. Є ще два варіанти:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"FAILURE"}]},{"type":"text","value":" - у цьому випадку після завершення завдання "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"workStatus.getState"}]},{"type":"text","value":" поверне "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"FAILED"}]},{"type":"text","value":". Для нас це сигнал, що завдання не було виконано."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"RETRY"}]},{"type":"text","value":" - а цей результат є сигналом для WorkManager, що завдання треба повторити. У цьому випадку "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"workStatus.getState"}]},{"type":"text","value":" поверне нам статус "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"ENQUEUED"}]},{"type":"text","value":" - тобто завдання знову заплановане."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Я протестував на емуляторі поведінку під час "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"RETRY"}]},{"type":"text","value":": перший раз завдання було перезапущено приблизно через одну хвилину після попереднього завершення. З кожним наступним перезапуском інтервал збільшувався:"}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes github-dark github-light monokai","code":"21:10:22.637 doWork: start\n21:10:32.638 doWork: end\n21:11:32.655 doWork: start\n21:11:42.657 doWork: end\n21:14:07.538 doWork: start\n21:14:17.543 doWork: end\n21:18:17.561 doWork: start\n21:18:27.602 doWork: end\n21:26:27.618 doWork: start\n21:26:37.653 doWork: end\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"21:10:22.637"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" doWork:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" start\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"21:10:32.638"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" doWork:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" end\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"21:11:32.655"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" doWork:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" start\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"21:11:42.657"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" doWork:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" end\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"21:14:07.538"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" doWork:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" start\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"21:14:17.543"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" doWork:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" end\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"21:18:17.561"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" doWork:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" start\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"21:18:27.602"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" doWork:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" end\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"21:26:27.618"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" doWork:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" start\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"21:26:37.653"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" doWork:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":" end\n"}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"скасування-завдання"},"children":[{"type":"text","value":"Скасування завдання"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Ми можемо скасувати завдання методом "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"cancelWorkById"}]},{"type":"text","value":", передавши "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"ID"}]},{"type":"text","value":" завдання"}]},{"type":"element","tag":"pre","props":{"className":"language-java shiki shiki-themes github-dark github-light monokai","code":"WorkManager.getInstance().cancelWorkById(myWorkRequest.getId());\n","language":"java","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"WorkManager."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"getInstance"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"()."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"cancelWorkById"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"(myWorkRequest."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"getId"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"());\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"При цьому в класі "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"MyWorker"}]},{"type":"text","value":" буде викликано метод "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"onStopped"}]},{"type":"text","value":" (якщо ви його реалізували). Також у класі "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"MyWorker"}]},{"type":"text","value":" ми завжди можемо використовувати "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"boolean"}]},{"type":"text","value":" метод "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"isStopped"}]},{"type":"text","value":" для перевірки того, що завдання було скасовано."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Якщо відстежуємо статус завдання, то "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"WorkStatus.getState"}]},{"type":"text","value":" поверне "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Cancelled"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Також є метод "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"cancelAllWork"}]},{"type":"text","value":", який скасує всі ваші завдання. Але хелп попереджає, що він вкрай небажаний до використання, тому що може зачепити роботу бібліотек, які ви використовуєте."}]},{"type":"element","tag":"h2","props":{"id":"tag"},"children":[{"type":"text","value":"Tag"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Завданню можна присвоїти тег методом "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"addTag"}]},{"type":"text","value":":"}]},{"type":"element","tag":"pre","props":{"className":"language-java shiki shiki-themes github-dark github-light monokai","code":"OneTimeWorkRequest myWorkRequest = new OneTimeWorkRequest.Builder(MyWorker.class)\n       .addTag(\"mytag\")\n       .build();\n","language":"java","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-dark-font-style:inherit;--shiki-default:#24292E;--shiki-default-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"OneTimeWorkRequest"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" myWorkRequest "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":" new"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" OneTimeWorkRequest."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"Builder"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"(MyWorker.class)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"       ."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"addTag"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"\"mytag\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"       ."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"build"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"();\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Одному завданню можна додавати кілька тегів."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"У "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"WorkStatus"}]},{"type":"text","value":" є метод "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"getTags"}]},{"type":"text","value":", який поверне всі теги, які присвоєні цьому завданню."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Присвоївши один тег кільком завданням, ми можемо всіх їх скасувати методом "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"cancelAllWorkByTag"}]},{"type":"text","value":":"}]},{"type":"element","tag":"pre","props":{"className":"language-java shiki shiki-themes github-dark github-light monokai","code":"WorkManager.getInstance().cancelAllWorkByTag(\"mytag\");\n","language":"java","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"WorkManager."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"getInstance"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"()."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"cancelAllWorkByTag"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#9ECBFF;--shiki-default:#032F62;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"\"mytag\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":");\n"}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"setinitialdelay"},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"setInitialDelay"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Виконання завдання можна відкласти на зазначений час"}]},{"type":"element","tag":"pre","props":{"className":"language-java shiki shiki-themes github-dark github-light monokai","code":"OneTimeWorkRequest myWorkRequest = new OneTimeWorkRequest.Builder(MyWorker.class)\n       .setInitialDelay(10, TimeUnit.SECONDS)\n       .build();\n","language":"java","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-dark-font-style:inherit;--shiki-default:#24292E;--shiki-default-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"OneTimeWorkRequest"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" myWorkRequest "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":" new"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" OneTimeWorkRequest."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"Builder"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"(MyWorker.class)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"       ."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"setInitialDelay"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5;--shiki-sepia:#AE81FF"},"children":[{"type":"text","value":"10"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":", TimeUnit.SECONDS)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"       ."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"build"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"();\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"У методі "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"setInitialDelay"}]},{"type":"text","value":" ми вказали, що завдання слід запустити через "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"10"}]},{"type":"text","value":" секунд після передачі його в "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"WorkManager.enqueue"}]}]},{"type":"element","tag":"h2","props":{"id":"періодичне-завдання"},"children":[{"type":"text","value":"Періодичне завдання"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Розглянутий нами "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"OneTimeWorkRequest"}]},{"type":"text","value":" - це разове завдання. А якщо потрібно багаторазове виконання через певний період часу, то можна використовувати "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"PeriodicWorkRequest"}]},{"type":"text","value":":"}]},{"type":"element","tag":"pre","props":{"className":"language-java shiki shiki-themes github-dark github-light monokai","code":"PeriodicWorkRequest myWorkRequest = new PeriodicWorkRequest.Builder(MyWorker.class, 30, TimeUnit.MINUTES)\n       .build();\n","language":"java","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-dark-font-style:inherit;--shiki-default:#24292E;--shiki-default-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"PeriodicWorkRequest"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" myWorkRequest "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":" new"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" PeriodicWorkRequest."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"Builder"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"(MyWorker.class, "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5;--shiki-sepia:#AE81FF"},"children":[{"type":"text","value":"30"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":", TimeUnit.MINUTES)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"       ."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"build"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"();\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"У білдері задаємо інтервал у "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"30"}]},{"type":"text","value":" хвилин. Тепер завдання буде виконуватися з цим інтервалом."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Мінімально доступний інтервал - "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"15"}]},{"type":"text","value":" хвилин. Якщо поставите менше, "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"WorkManager"}]},{"type":"text","value":" сам підвищить до "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"15"}]},{"type":"text","value":" хвилин."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"WorkManager"}]},{"type":"text","value":" гарантує, що завдання буде запущено один раз протягом зазначеного інтервалу. І це може статися в будь-який момент інтервалу - через "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"1"}]},{"type":"text","value":" хвилину, через "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"10"}]},{"type":"text","value":" або через "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"29"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"За допомогою параметра "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"flex"}]},{"type":"text","value":" можна обмежити дозволений діапазон часу запуску."}]},{"type":"element","tag":"pre","props":{"className":"language-java shiki shiki-themes github-dark github-light monokai","code":"PeriodicWorkRequest myWorkRequest = new PeriodicWorkRequest.Builder(MyWorker.class, 30, TimeUnit.MINUTES, 25, TimeUnit.MINUTES)\n       .build();\n","language":"java","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-dark-font-style:inherit;--shiki-default:#24292E;--shiki-default-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"PeriodicWorkRequest"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" myWorkRequest "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#F97583;--shiki-default:#D73A49;--shiki-sepia:#F92672"},"children":[{"type":"text","value":" new"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":" PeriodicWorkRequest."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"Builder"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"(MyWorker.class, "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5;--shiki-sepia:#AE81FF"},"children":[{"type":"text","value":"30"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":", TimeUnit.MINUTES, "}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#79B8FF;--shiki-default:#005CC5;--shiki-sepia:#AE81FF"},"children":[{"type":"text","value":"25"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":", TimeUnit.MINUTES)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"       ."}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#B392F0;--shiki-default:#6F42C1;--shiki-sepia:#A6E22E"},"children":[{"type":"text","value":"build"}]},{"type":"element","tag":"span","props":{"style":"--shiki-dark:#E1E4E8;--shiki-default:#24292E;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"();\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Крім інтервалу в "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"30"}]},{"type":"text","value":" хвилин додатково передаємо в білдер "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"flex"}]},{"type":"text","value":" параметр "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"25"}]},{"type":"text","value":" хвилин. Тепер завдання буде запущено не в будь-який момент "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"30"}]},{"type":"text","value":"-хвилинного інтервалу, а тільки після "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"25"}]},{"type":"text","value":"-ї хвилини. Тобто між "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"25"}]},{"type":"text","value":" і "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"30"}]},{"type":"text","value":" хвилинами."}]},{"type":"element","tag":"h2","props":{"id":"context"},"children":[{"type":"text","value":"Context"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Щоб отримати "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Context"}]},{"type":"text","value":" у класі "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Worker"}]},{"type":"text","value":", використовуйте метод "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"getApplicationContext"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h2","props":{"id":"перезавантаження"},"children":[{"type":"text","value":"Перезавантаження"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Що відбувається із запланованими завданнями під час перезавантаження пристрою? Я протестував цей кейс на емуляторі і з'ясував, що всі завдання зберігаються. Тобто "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"OneTimeWorkRequest"}]},{"type":"text","value":" з відкладеним запуском, "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"OneTimeWorkRequest"}]},{"type":"text","value":" з результатом "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"RETRY"}]},{"type":"text","value":", "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"PeriodicWorkRequest"}]},{"type":"text","value":" - всі ці завдання будуть знову запущені після перезавантаження пристрою."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Тому дійте обдумано і зберігайте десь у себе ID або тег завдання, щоб ви могли його скасувати, якщо воно вам більше не потрібне."}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"завдання","depth":2,"text":"Завдання"},{"id":"статус-завдання","depth":2,"text":"Статус завдання"},{"id":"скасування-завдання","depth":2,"text":"Скасування завдання"},{"id":"tag","depth":2,"text":"Tag"},{"id":"setinitialdelay","depth":2,"text":"setInitialDelay"},{"id":"періодичне-завдання","depth":2,"text":"Періодичне завдання"},{"id":"context","depth":2,"text":"Context"},{"id":"перезавантаження","depth":2,"text":"Перезавантаження"}]}},"_type":"markdown","_id":"content:1.android:10.lesson10:1.work-manager.md","_source":"content","_file":"1.android/10.lesson10/1.work-manager.md","_stem":"1.android/10.lesson10/1.work-manager","_extension":"md"}